# Ostrozon 시스템 패턴

## 시스템 아키텍처

Ostrozon은 Next.js 기반의 모던 웹 애플리케이션으로, React를 활용한 프론트엔드와 API 라우트를 통한 백엔드 기능을 통합적으로 제공합니다.

### 아키텍처 다이어그램

```
+---------------------+    +-------------------+    +---------------------+
|                     |    |                   |    |                     |
|  Client Browser     |<-->|  Next.js App      |<-->|  External Services  |
|                     |    |                   |    |                     |
+---------------------+    +---------+---------+    +---------------------+
                                     |
                                     v
                           +-------------------+
                           |                   |
                           |  Database         |
                           |                   |
                           +-------------------+
```

## 주요 기술적 결정

1. **Next.js 프레임워크 선택**: 서버 사이드 렌더링(SSR)과 정적 사이트 생성(SSG)을 통한 SEO 최적화 및 성능 향상
2. **Tailwind CSS 적용**: 유틸리티 기반 스타일링으로 일관된 디자인 시스템 구현
3. **Zustand 상태 관리**: Redux와 같은 복잡한 상태 관리 대신 경량화된 Zustand 사용
4. **React Query 데이터 페칭**: 서버 상태 관리 및 캐싱을 위한 React Query 적용
5. **모듈 기반 구조**: 기능별 모듈화를 통한 코드 유지보수성 향상

## 디자인 패턴

### 컴포넌트 패턴

1. **아토믹 디자인 시스템**: 
   - Atoms: 버튼, 인풋, 아이콘 등 기본 UI 요소
   - Molecules: 카드, 폼 필드, 미니 플레이어 등 복합 요소
   - Organisms: 네비게이션 바, 카드 그리드, 푸터 등 복잡한 컴포넌트
   - Templates: 페이지 레이아웃 구조
   - Pages: 실제 라우트와 연결된 완전한 페이지

2. **Container/Presenter 패턴**:
   - Container 컴포넌트: 데이터 페칭 및 상태 관리 담당
   - Presenter 컴포넌트: UI 렌더링 담당

3. **HOC 및 Custom Hooks**:
   - 인증, 권한 관리 등 횡단 관심사를 위한 HOC 활용
   - 데이터 페칭, 폼 관리 등을 위한 Custom Hooks 활용

### 데이터 흐름 패턴

1. **단방향 데이터 흐름**:
   - 부모에서 자식으로의 props 전달
   - 상태 업데이트는 이벤트 핸들러를 통해 상위 컴포넌트로 전달

2. **전역 상태 관리**:
   - Zustand를 통한 모듈화된 상태 관리
   - 필요한 부분에만 상태 구독

3. **데이터 페칭 전략**:
   - React Query를 활용한 선언적 데이터 페칭
   - 캐싱 및 재검증 로직 자동화
   - 서버 사이드 렌더링과 클라이언트 사이드 렌더링 혼합 사용

### 미디어 플레이어 관리 패턴

1. **중앙화된 미디어 상태 관리**:
   - Zustand 스토어를 통한 전역 미디어 상태 관리
   - `currentMedia`, `isPlaying`, `volume` 등 미디어 관련 상태 통합 관리
   - `togglePlayState` 함수를 통한 재생 상태 직접 제어

2. **다중 플레이어 조정 전략**:
   - Observer 패턴을 활용한 플레이어 간 상태 감시
   - 유튜브 플레이어 이벤트(`onStateChange`)를 통한 재생 상태 감지
   - useEffect 훅을 통한 미디어 플레이어 간 상태 동기화

3. **예외 처리 및 안정성 확보**:
   - Try-Catch 블록을 통한 플레이어 API 호출 안전성 확보
   - 조건부 메서드 호출로 초기화되지 않은 플레이어에 대한 방어 코드 구현
   - 이전 상태 참조(useRef)를 통한 미디어 플레이어 상태 복원 메커니즘

4. **플레이어 상태 전환 흐름**:
   ```
   +----------------+     +----------------+     +----------------+
   |                |     |                |     |                |
   | 메인 플레이어 재생 +---->+ 유튜브 영상 시작 +---->+ 메인 플레이어 중지|
   |                |     |                |     |                |
   +-------+--------+     +-------+--------+     +----------------+
           ^                      |
           |                      v
   +-------+--------+     +----------------+
   |                |     |                |
   | 상태 복원       |<----+ 유튜브 영상 종료 |
   |                |     |                |
   +----------------+     +----------------+
   ```

## 컴포넌트 관계도

```
+----------------+
|                |
|    Layout      |
|                |
+-------+--------+
        |
+-------v--------+     +----------------+
|                |     |                |
|   Pages        +---->+   Components   |
|                |     |                |
+----------------+     +-------+--------+
                               |
                       +-------v--------+
                       |                |
                       |   Hooks        |
                       |                |
                       +----------------+
```

## 반응형 디자인 전략

- **모바일 퍼스트 접근**: 모든 컴포넌트는 모바일 기기를 우선적으로 디자인
- **Tailwind 브레이크포인트**: sm, md, lg, xl, 2xl 브레이크포인트에 따른 반응형 디자인
- **그리드 시스템**: 모바일에서 1열, 태블릿에서 2열, 데스크톱에서 3열 등 유동적인 그리드 사용

## API 인터페이스

### 내부 API 라우트

- `/api/news`: 뉴스 관련 CRUD 작업
- `/api/station`: 스테이션 관련 CRUD 작업
- `/api/content`: 통합 콘텐츠 조회 및 필터링
- `/api/auth`: 인증 및 사용자 관리

### 외부 API 통합

- YouTube API: 비디오 콘텐츠 통합 및 제어
  - `onReady`: 플레이어 초기화 이벤트 처리
  - `onStateChange`: 플레이어 상태 변경 감지 및 대응
  - `playVideo`/`pauseVideo`: 플레이어 제어 메서드
- SoundCloud API: 오디오 스트리밍 (향후 계획)
- 소셜 미디어 API: 소셜 로그인 및 공유 기능 (향후 계획)

## 성능 최적화 전략

1. **코드 스플리팅**: 필요한 코드만 로드하도록 분할
2. **이미지 최적화**: Next.js의 Image 컴포넌트 활용
3. **레이지 로딩**: 뷰포트에 나타날 때만 콘텐츠 로드
4. **메모이제이션**: React.memo, useMemo, useCallback 활용
5. **SSR/SSG 활용**: 성능과 SEO 최적화를 위한 서버 사이드 렌더링 및 정적 사이트 생성 